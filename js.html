<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        div {
            border: 1px solid black;
        }
        button {
            background-color: white;
        }
        .text {
            width: 300px;
            height: 40px;
            text-align: center;
            display: table-cell;
            vertical-align: middle;
        }
        .btPhone {
            width: 90px;
            height: 90px;
            margin: 3px;
        }
        .btPhone_1 {
            width: 90px;
            height: 90px;
            margin: 3px;
        }
        #setAmount {
            margin-left: 110px;
            margin-top: 5px;
            margin-bottom: 5px;
        }
        #saveAmount {
            margin-left: 127.5px;
            margin-top: 5px;
            margin-bottom: 5px;
        }
        #phone {
            width: 300px;
            height: 385px;
            margin-top: 5px;
        }
    </style>
    <script src="jquery-3.5.1.min.js"></script>
    <script>
        function getRandomInt(min, max) { //랜덤
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }
        function btAmount() { // 금액설정 버튼
            $("#amount").html(getRandomInt(1, 100) +",000원");
        }
        function btPhone() { // 휴대폰 번호 입력 버튼
            let textLength = $("#setPhoneNum").text().length;
            if(textLength > 0 && textLength < 4 && textLength%3 == 0) {//휴대폰 번호 입력 (4번째 자리에 - 표시)
                $("#setPhoneNum").append("-" + this.value);
            } else if(textLength > 4 && textLength < 12 && textLength%8 == 0) {//(9번째 자리에 - 표시)
                $("#setPhoneNum").append("-" + this.value);
            } else
                $("#setPhoneNum").append(this.value);
        }
        function btBackSpace() { //backSpace 버튼
            let str = $('#setPhoneNum').text();
            if (str.substr(str.length-2, 1) == "-") {
                $('#setPhoneNum').html(str.substring(0, str.length-2));
            } else {
                $('#setPhoneNum').html(str.substring(0, str.length-1));
            }
        }

        function createItem() {
            //localStorage.setItem($("#setPhoneNum").text(), $("#amount").text(), Date.now());
            localStorage.setItem($("#setPhoneNum").text(), JSON.stringify(obj));
        }
        function saveAmount() {
            let x = JSON.parse(localStorage.getItem($("#setPhoneNum").text()));
            let a = {};
            if(x==null) { //해당 휴대폰 번호가 존재하지 않을 때
                a.amount = [$("#amount").text()];
                a.count = 1;
                a.date = [new Date().toLocaleDateString()];
                localStorage.setItem($("#setPhoneNum").text(), JSON.stringify(a));
            } else { //휴대폰 번호가 존재할 때
                x.amount.push($("#amount").text());
                x.count++;
                x.date.push(new Date().toLocaleDateString());
                localStorage.setItem($("#setPhoneNum").text(), JSON.stringify(x));
            }
        }

        $(document).ready(function() {
            $("#setAmount").click(btAmount);
            $("#backSpace").click(btBackSpace);
            $(".btPhone").click(btPhone);
            //$("#saveAmount").click(createItem);
            $("#saveAmount").click(saveAmount);

            //document.querySelector("#setAmount").addEventListener("click", btAmount);
            //document.querySelector("#backSpace").addEventListener("click", btBackSpace);
            /*let phoneBt = document.querySelectorAll(".btPhone");
            for(let item of phoneBt){
                item.addEventListener("click", btPhone);
            }*/
        });
    </script>
</head>
<body>
    <div class = "text" id="amount"></div>
    <button id="setAmount">금액 설정</button>
    <div class = "text" id="setPhoneNum"></div>
    <div id="phone">
        <button class="btPhone" value="1">1</button>
        <button class="btPhone" value="2">2</button>
        <button class="btPhone" value="3">3</button>
        <button class="btPhone" value="4">4</button>
        <button class="btPhone" value="5">5</button>
        <button class="btPhone" value="6">6</button>
        <button class="btPhone" value="7">7</button>
        <button class="btPhone" value="8">8</button>
        <button class="btPhone" value="9">9</button>
        <button class="btPhone_1" onclick="$('#setPhoneNum').empty();">C</button>
        <button class="btPhone" value="0">0</button>
        <button id="backSpace" class="btPhone_1">X</button>
        <!--<button id="backSpace" class="btPhone_1" onclick="$('#setPhoneNum').html($('#setPhoneNum').text().substring(0, $('#setPhoneNum').text().length-1))">X</button>-->
        <!--exp.value = exp.value.substring(0, exp.value.length-1);-->
        <!--$(input).val($(input).val().substring(0, $(input).val().length - 1));-->
    </div>
    <button id="saveAmount">저장</button>
    <div id="milege"></div>
</body>
</html>